* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v2.0 on Apr, 26. 2014.
* ASSEMBLE PREVIOUSLY GENERATED COMPONENTS 
* 

DIMENS CHSIZE 1000000
ioformat exten
stream ./toppar.str

!
! go by cnt for each detergent
!

!open write unit 90 card name test_all36_detergent.result
!write title unit 90
!* detergent refener ener diff
!* 

!set maxcnt = 5
set maxcnt = 5

set cnt = 1
label dolist

! IF CNT .EQ. 1 THEN
!    SET LIPID   = DPC
!    SET REFENER = 33.1885
! ENDIF
! IF CNT .EQ. 2 THEN
!    SET LIPID   = SDS
!    SET REFENER = 90.9395
! ENDIF
! IF CNT .EQ. 3 THEN
!    SET LIPID   = TPC
!    SET REFENER = 63.5235
! ENDIF
! IF CNT .EQ. 4 THEN
!    SET LIPID   = DHPC
!    SET REFENER = 76.1631
! ENDIF
! IF CNT .EQ. 5 THEN
!    SET LIPID   = LMPG
!    SET REFENER = 112.299
! ENDIF

IF CNT .EQ. 1 THEN
   SET LIPID   = SDS
   SET REFENER = 90.9395
ENDIF
IF CNT .EQ. 2 THEN
   SET LIPID   = LMPG
   SET REFENER = 112.299
ENDIF



   read sequence @lipid 1
   generate @lipid setup warn

   open read unit 10 card name ./lipid/test_all36_lipid_crd/@lipid.crd
   read coor unit 10 card 

   energy

   calc diff = ?ener - @refener 

!   write title unit 90
!   * @lipid @refener ?ener @diff
!   *

   delete atom

increase cnt by 1
if cnt .le. @maxcnt goto dolist

! fatty acid section

set cnt 1
set maxcnt 74

label dolist2

if cnt .eq. 1 then
 set lipid LAU
endif
if cnt .eq. 2 then
 set lipid MYR
endif
if cnt .eq. 3 then
 set lipid PAL
endif
if cnt .eq. 4 then
 set lipid STE 
endif
if cnt .eq. 5 then
 set lipid ARA 
endif
if cnt .eq. 6 then
 set lipid BEH 
endif
if cnt .eq. 7 then
 set lipid TRI 
endif
if cnt .eq. 8 then
 set lipid LIGN
endif
if cnt .eq. 9 then
 set lipid MYRO
endif
if cnt .eq. 10 then
 set lipid PALO
endif
if cnt .eq. 11 then
 set lipid HTA 
endif
if cnt .eq. 12 then
 set lipid OLE 
endif
if cnt .eq. 13 then
 set lipid LIN 
endif
if cnt .eq. 14 then
 set lipid ALIN
endif
if cnt .eq. 15 then
 set lipid SDA 
endif
if cnt .eq. 16 then
 set lipid GLA 
endif
if cnt .eq. 17 then
 set lipid EICO
endif
if cnt .eq. 18 then
 set lipid EDA 
endif
if cnt .eq. 19 then
 set lipid MEA 
endif
if cnt .eq. 20 then
 set lipid DGLA
endif
if cnt .eq. 21 then
 set lipid ETE 
endif
if cnt .eq. 22 then
 set lipid ETA 
endif
if cnt .eq. 23 then
 set lipid EPA 
endif
if cnt .eq. 24 then
 set lipid ARAN
endif
if cnt .eq. 25 then
 set lipid HPA 
endif
if cnt .eq. 26 then
 set lipid ERU 
endif
if cnt .eq. 27 then
 set lipid DDA 
endif
if cnt .eq. 28 then
 set lipid ADR 
endif
if cnt .eq. 29 then
 set lipid DPT 
endif
if cnt .eq. 30 then
 set lipid DPA 
endif
if cnt .eq. 31 then
 set lipid DHA 
endif
if cnt .eq. 32 then
 set lipid NER 
endif
if cnt .eq. 33 then
 set lipid TTA 
endif
if cnt .eq. 34 then
 set lipid TPT 
endif
if cnt .eq. 35 then
 set lipid TPA 
endif
if cnt .eq. 36 then
 set lipid THA 
endif
if cnt .eq. 37 then
 set lipid LAUP
endif
if cnt .eq. 38 then
 set lipid MYRP
endif
if cnt .eq. 39 then
 set lipid PALP
endif
if cnt .eq. 40 then
 set lipid STEP
endif
if cnt .eq. 41 then
 set lipid ARAP
endif
if cnt .eq. 42 then
 set lipid BEHP
endif
if cnt .eq. 43 then
 set lipid TRIP
endif
if cnt .eq. 44 then
 set lipid LIGNP
endif
if cnt .eq. 45 then
 set lipid MYROP
endif
if cnt .eq. 46 then
 set lipid PALOP
endif
if cnt .eq. 47 then
 set lipid HTAP
endif
if cnt .eq. 48 then
 set lipid OLEP
endif
if cnt .eq. 49 then
 set lipid LINP
endif
if cnt .eq. 50 then
 set lipid ALINP
endif
if cnt .eq. 51 then
 set lipid SDAP
endif
if cnt .eq. 52 then
 set lipid GLAP
endif
if cnt .eq. 53 then
 set lipid EICOP
endif
if cnt .eq. 54 then
 set lipid EDAP
endif
if cnt .eq. 55 then
 set lipid MEAP
endif
if cnt .eq. 56 then
 set lipid DGLAP
endif
if cnt .eq. 57 then
 set lipid ETEP
endif
if cnt .eq. 58 then
 set lipid ETAP
endif
if cnt .eq. 59 then
 set lipid EPAP
endif
if cnt .eq. 60 then
 set lipid ARANP
endif
if cnt .eq. 61 then
 set lipid HPAP
endif
if cnt .eq. 62 then
 set lipid ERUP
endif
if cnt .eq. 63 then
 set lipid DDAP
endif
if cnt .eq. 64 then
 set lipid ADRP
endif
if cnt .eq. 65 then
 set lipid DPTP
endif
if cnt .eq. 66 then
 set lipid DPAP
endif
if cnt .eq. 67 then
 set lipid DHAP
endif
if cnt .eq. 68 then
 set lipid NERP
endif
if cnt .eq. 69 then
 set lipid TTAP
endif
if cnt .eq. 70 then
 set lipid TPTP
endif
if cnt .eq. 71 then
 set lipid TPAP
endif
if cnt .eq. 72 then
 set lipid THAP
endif
if cnt .eq. 73 then
 set lipid SB3-12
endif
if cnt .eq. 74 then
 set lipid SB3-14
endif

   read sequence @lipid 1
   generate @lipid setup warn

if cnt .le. 72 then
   ic param
   ic seed 1 O1 1 C1 1 C2
   ic build
endif

if cnt .eq. 73 then
   ic param
   ic seed 1 O1 1 S 1 O2
   ic build
endif

if cnt .eq. 74 then
   ic param
   ic seed 1 O1 1 S 1 O2
   ic build
endif

   energy

!write coor pdb name pdb/@lipid_gen.pdb
!mini SD nstep 500
!mini abnr nstep 200
!ic fill
!ic print
!write coor pdb name pdb/@lipid_min.pdb

!   calc diff = ?ener - @refener 
!   write title unit 90
!   * @lipid @refener ?ener @diff
!   *

   delete atom

increase cnt by 1
delete atom select all end
if cnt .le. @maxcnt goto dolist2

! imlab

set cnt 1
set maxcnt 35

label dolist3

if cnt .eq. 1 then
 set lipid FOS10
endif
if cnt .eq. 2 then
 set lipid CYFOS3
endif
if cnt .eq. 3 then
 set lipid CYFOS4
endif
if cnt .eq. 4 then
 set lipid CYFOS5
endif
if cnt .eq. 5 then
 set lipid CYFOS6
endif
if cnt .eq. 6 then
 set lipid CYFOS7
endif
if cnt .eq. 7 then
 set lipid FOIS9
endif
if cnt .eq. 8 then
 set lipid FOIS11
endif
if cnt .eq. 9 then
 set lipid FOS12
endif
if cnt .eq. 10 then
 set lipid FOS13
endif
if cnt .eq. 11 then
 set lipid FOS14
endif
if cnt .eq. 12 then
 set lipid FOS15
endif
if cnt .eq. 13 then
 set lipid FOS16
endif
if cnt .eq. 14 then
 set lipid UFOS10
endif
if cnt .eq. 15 then
 set lipid C7DHPC
endif
if cnt .eq. 16 then
 set lipid C6DHPC
endif
if cnt .eq. 17 then
 set lipid LPC12
endif
if cnt .eq. 18 then
 set lipid LPC14
endif
if cnt .eq. 19 then
 set lipid SB3-10
endif
if cnt .eq. 20 then
 set lipid LAPAO
endif
if cnt .eq. 21 then
 set lipid LAPAOP
endif
if cnt .eq. 22 then
 set lipid TRIPAO
endif
if cnt .eq. 23 then
 set lipid TRPAOP
endif
if cnt .eq. 24 then
 set lipid DDMG
endif
if cnt .eq. 25 then
 set lipid DOMG
endif
if cnt .eq. 26 then
 set lipid DDAO
endif
if cnt .eq. 27 then
 set lipid DDAOP
endif
if cnt .eq. 28 then
 set lipid UDAO
endif
if cnt .eq. 29 then
 set lipid UDAOP
endif
if cnt .eq. 30 then
 set lipid LDAO
endif
if cnt .eq. 31 then
 set lipid LDAOP
endif
if cnt .eq. 32 then
 set lipid CHAPS
endif
if cnt .eq. 33 then
 set lipid CHAPSO
endif
if cnt .eq. 34 then
 set lipid THCHL
endif
if cnt .eq. 35 then
 set lipid THDPPC
endif


if @lipid .eq. FOS10 set isdet1 = uic2
if @lipid .eq. CYFOS3 set isdet1 = uic2
if @lipid .eq. CYFOS4 set isdet1 = uic2
if @lipid .eq. CYFOS5 set isdet1 = uic2
if @lipid .eq. CYFOS6 set isdet1 = uic2
if @lipid .eq. CYFOS7 set isdet1 = uic2
if @lipid .eq. FOIS9 set isdet1 = uic2
if @lipid .eq. FOIS11 set isdet1 = uic2
if @lipid .eq. FOS12 set isdet1 = uic2
if @lipid .eq. FOS13 set isdet1 = uic2
if @lipid .eq. FOS14 set isdet1 = uic2
if @lipid .eq. FOS15 set isdet1 = uic2
if @lipid .eq. FOS16 set isdet1 = uic2
if @lipid .eq. UFOS10 set isdet1 = uic2
if @lipid .eq. C7DHPC set isdet1 = uic2
if @lipid .eq. C6DHPC set isdet1 = uic2
if @lipid .eq. LPC12 set isdet1 = uic2
if @lipid .eq. LPC14 set isdet1 = uic2
if @lipid .eq. SB3-10 set isdet1 = uic1
if @lipid .eq. LAPAO set isdet1 = uic1
if @lipid .eq. LAPAOP set isdet1 = uic1
if @lipid .eq. TRIPAO set isdet1 = uic1
if @lipid .eq. TRPAOP set isdet1 = uic1
if @lipid .eq. DDMG set isdet1 = uic1
if @lipid .eq. DOMG set isdet1 = uic1
if @lipid .eq. DDAO set isdet1 = uic1
if @lipid .eq. DDAOP set isdet1 = uic1
if @lipid .eq. UDAO set isdet1 = uic1
if @lipid .eq. UDAOP set isdet1 = uic1
if @lipid .eq. LDAO set isdet1 = uic1
if @lipid .eq. LDAOP set isdet1 = uic1
if @lipid .eq. CHAPS set isdet1 = uic3
if @lipid .eq. CHAPSO set isdet1 = uic3
if @lipid .eq. THCHL set isdet1 = uic1
if @lipid .eq. THDPPC set isdet1 = uic1

read sequ card unit 5
* @lipid
*
1
@lipid
gene @lipid first none last none setup
autogenerate angle dihe

if @isdet1 .eq. uic1 ic seed 1 C1 1 C2 1 C3
if @isdet1 .eq. uic2 ic seed 1 N 1 C12 1 C11
if @isdet1 .eq. uic3 ic seed 1 C3 1 C4 1 C5
if @isdet1 .eq. uic4 ic seed 1 1C1 1 1C2 1 1C3
if @isdet1 .eq. uic5 ic seed 1 N1 1 C2 1 C3   !used in AMHCG
if @isdet1 .eq. uic6 ic seed 1 2C1 1 2C2 1 2C3

ic para
ic build

energy

!open unit 10 write form name pdb/@lipid.pdb
!write coor pdb unit 10
!* @lipid
!*

delete atom select all end

increase cnt by 1
delete atom select all end
if cnt .le. @maxcnt goto dolist3

!2019_7 additions
set resi LPPG
read sequ card unit 5
* @resi
*
1
@resi
gene @resi first none last none setup
autogenerate angle dihe
ic para
ic seed @resi 1 C1 @resi 1 C2 @resi 1 C3
ic build

energy

!open unit 10 write form name pdb/@lipid.pdb
!write coor pdb unit 10
!* @lipid
!*

delete atom select all end

stop

